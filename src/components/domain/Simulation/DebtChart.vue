<template>
  <div :class="styles['debt-chart-wrapper']">
    <h3 :class="styles['chart-title']">부채 감소 추이</h3>
    <Line :data="chartData" :options="chartOptions" />
  </div>
</template>

<script setup>
import { ref, computed, watch } from 'vue';
import { Line } from 'vue-chartjs';
import dayjs from 'dayjs';
import styles from '@/assets/styles/pages/RepaymentSimulation.module.css';
import {
  Chart as ChartJS,
  Title,
  Tooltip,
  Legend,
  LineElement,
  PointElement,
  CategoryScale,
  LinearScale,
} from 'chart.js';

ChartJS.register(
  Title,
  Tooltip,
  Legend,
  LineElement,
  PointElement,
  CategoryScale,
  LinearScale
);

const props = defineProps({
  repayments: {
    type: Array,
    default: () => [],
  },
});

const testRepayments = ref([
  {
    strategyType: 'TCS_RECOMMEND',
    totalMonths: 35,
    interestSaved: 1047115,
    totalPayment: 23215666,
    originalPayment: 24262781,
    totalPrepaymentFee: 4205,
    sortedLoanNames: [
      '사금융 소액 고금리 대출',
      '은행 고금리 대출',
      '보험사 중금리 대출',
    ],
    repaymentHistory: {
      '사금융 소액 고금리 대출': [
        {
          principal: 190247,
          interest: 25000,
          prepayment: 200000,
          prepaymentFee: 381,
          totalPayment: 415628,
          paymentDate: '2025-08-15',
          remainingPrincipal: 609753,
        },
        {
          principal: 146839,
          interest: 15244,
          prepayment: 200000,
          prepaymentFee: 296,
          totalPayment: 362379,
          paymentDate: '2025-09-15',
          remainingPrincipal: 262914,
        },
        {
          principal: 85483,
          interest: 6573,
          prepayment: 177431,
          prepaymentFee: 190,
          totalPayment: 269677,
          paymentDate: '2025-10-15',
          remainingPrincipal: 0,
        },
      ],
      '은행 고금리 대출': [
        {
          principal: 232869,
          interest: 266667,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-08-15',
          remainingPrincipal: 9767131,
        },
        {
          principal: 239079,
          interest: 260457,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-09-15',
          remainingPrincipal: 9528052,
        },
        {
          principal: 245455,
          interest: 254081,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-10-15',
          remainingPrincipal: 9282597,
        },
        {
          principal: 252000,
          interest: 247536,
          prepayment: 200000,
          prepaymentFee: 1702,
          totalPayment: 701238,
          paymentDate: '2025-11-15',
          remainingPrincipal: 8830597,
        },
        {
          principal: 252990,
          interest: 235483,
          prepayment: 200000,
          prepaymentFee: 1636,
          totalPayment: 690109,
          paymentDate: '2025-12-15',
          remainingPrincipal: 8377607,
        },
        {
          principal: 253681,
          interest: 223403,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 677083,
          paymentDate: '2026-01-15',
          remainingPrincipal: 7923926,
        },
        {
          principal: 254034,
          interest: 211305,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 665338,
          paymentDate: '2026-02-15',
          remainingPrincipal: 7469892,
        },
        {
          principal: 254007,
          interest: 199197,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 653204,
          paymentDate: '2026-03-15',
          remainingPrincipal: 7015885,
        },
        {
          principal: 253553,
          interest: 187090,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 640643,
          paymentDate: '2026-04-15',
          remainingPrincipal: 6562332,
        },
        {
          principal: 252615,
          interest: 174996,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 627611,
          paymentDate: '2026-05-15',
          remainingPrincipal: 6109717,
        },
        {
          principal: 251131,
          interest: 162926,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 614057,
          paymentDate: '2026-06-15',
          remainingPrincipal: 5658586,
        },
        {
          principal: 249026,
          interest: 150896,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 599921,
          paymentDate: '2026-07-15',
          remainingPrincipal: 5209560,
        },
        {
          principal: 246214,
          interest: 138922,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 585136,
          paymentDate: '2026-08-15',
          remainingPrincipal: 4763346,
        },
        {
          principal: 242594,
          interest: 127023,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 569617,
          paymentDate: '2026-09-15',
          remainingPrincipal: 4320752,
        },
        {
          principal: 238044,
          interest: 115220,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 553265,
          paymentDate: '2026-10-15',
          remainingPrincipal: 3882708,
        },
        {
          principal: 232420,
          interest: 103539,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 535959,
          paymentDate: '2026-11-15',
          remainingPrincipal: 3450288,
        },
        {
          principal: 225544,
          interest: 92008,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 517552,
          paymentDate: '2026-12-15',
          remainingPrincipal: 3024744,
        },
        {
          principal: 217197,
          interest: 80660,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 497857,
          paymentDate: '2027-01-15',
          remainingPrincipal: 2607547,
        },
        {
          principal: 207104,
          interest: 69535,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 476639,
          paymentDate: '2027-02-15',
          remainingPrincipal: 2200443,
        },
        {
          principal: 194912,
          interest: 58678,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 453590,
          paymentDate: '2027-03-15',
          remainingPrincipal: 1805531,
        },
        {
          principal: 180153,
          interest: 48147,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 428301,
          paymentDate: '2027-04-15',
          remainingPrincipal: 1425378,
        },
        {
          principal: 162199,
          interest: 38010,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 400209,
          paymentDate: '2027-05-15',
          remainingPrincipal: 1063179,
        },
        {
          principal: 140158,
          interest: 28351,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 368510,
          paymentDate: '2027-06-15',
          remainingPrincipal: 723021,
        },
        {
          principal: 112716,
          interest: 19281,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 331997,
          paymentDate: '2027-07-15',
          remainingPrincipal: 410305,
        },
        {
          principal: 77800,
          interest: 10941,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 288741,
          paymentDate: '2027-08-15',
          remainingPrincipal: 132505,
        },
        {
          principal: 31830,
          interest: 3533,
          prepayment: 100675,
          prepaymentFee: 0,
          totalPayment: 136038,
          paymentDate: '2027-09-15',
          remainingPrincipal: 0,
        },
      ],
      '보험사 중금리 대출': [
        {
          principal: 195122,
          interest: 33333,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 228455,
          paymentDate: '2025-08-15',
          remainingPrincipal: 7804878,
        },
        {
          principal: 195122,
          interest: 32520,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 227642,
          paymentDate: '2025-09-15',
          remainingPrincipal: 7609756,
        },
        {
          principal: 195122,
          interest: 31707,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 226829,
          paymentDate: '2025-10-15',
          remainingPrincipal: 7414634,
        },
        {
          principal: 195122,
          interest: 30894,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 226016,
          paymentDate: '2025-11-15',
          remainingPrincipal: 7219512,
        },
        {
          principal: 195122,
          interest: 30081,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 225203,
          paymentDate: '2025-12-15',
          remainingPrincipal: 7024390,
        },
        {
          principal: 195122,
          interest: 29268,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 224390,
          paymentDate: '2026-01-15',
          remainingPrincipal: 6829268,
        },
        {
          principal: 195122,
          interest: 28455,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 223577,
          paymentDate: '2026-02-15',
          remainingPrincipal: 6634146,
        },
        {
          principal: 195122,
          interest: 27642,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 222764,
          paymentDate: '2026-03-15',
          remainingPrincipal: 6439024,
        },
        {
          principal: 195122,
          interest: 26829,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 221951,
          paymentDate: '2026-04-15',
          remainingPrincipal: 6243902,
        },
        {
          principal: 195122,
          interest: 26016,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 221138,
          paymentDate: '2026-05-15',
          remainingPrincipal: 6048780,
        },
        {
          principal: 195122,
          interest: 25203,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 220325,
          paymentDate: '2026-06-15',
          remainingPrincipal: 5853658,
        },
        {
          principal: 195122,
          interest: 24390,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 219512,
          paymentDate: '2026-07-15',
          remainingPrincipal: 5658536,
        },
        {
          principal: 195122,
          interest: 23577,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 218699,
          paymentDate: '2026-08-15',
          remainingPrincipal: 5463414,
        },
        {
          principal: 195122,
          interest: 22764,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 217886,
          paymentDate: '2026-09-15',
          remainingPrincipal: 5268292,
        },
        {
          principal: 195122,
          interest: 21951,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 217073,
          paymentDate: '2026-10-15',
          remainingPrincipal: 5073170,
        },
        {
          principal: 195122,
          interest: 21138,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 216260,
          paymentDate: '2026-11-15',
          remainingPrincipal: 4878048,
        },
        {
          principal: 195122,
          interest: 20325,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 215447,
          paymentDate: '2026-12-15',
          remainingPrincipal: 4682926,
        },
        {
          principal: 195122,
          interest: 19512,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 214634,
          paymentDate: '2027-01-15',
          remainingPrincipal: 4487804,
        },
        {
          principal: 195122,
          interest: 18699,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 213821,
          paymentDate: '2027-02-15',
          remainingPrincipal: 4292682,
        },
        {
          principal: 195122,
          interest: 17886,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 213008,
          paymentDate: '2027-03-15',
          remainingPrincipal: 4097560,
        },
        {
          principal: 195122,
          interest: 17073,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 212195,
          paymentDate: '2027-04-15',
          remainingPrincipal: 3902438,
        },
        {
          principal: 195122,
          interest: 16260,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 211382,
          paymentDate: '2027-05-15',
          remainingPrincipal: 3707316,
        },
        {
          principal: 195122,
          interest: 15447,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 210569,
          paymentDate: '2027-06-15',
          remainingPrincipal: 3512194,
        },
        {
          principal: 195122,
          interest: 14634,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 209756,
          paymentDate: '2027-07-15',
          remainingPrincipal: 3317072,
        },
        {
          principal: 195122,
          interest: 13821,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 208943,
          paymentDate: '2027-08-15',
          remainingPrincipal: 3121950,
        },
        {
          principal: 195122,
          interest: 13008,
          prepayment: 67495,
          prepaymentFee: 0,
          totalPayment: 275625,
          paymentDate: '2027-09-15',
          remainingPrincipal: 2859333,
        },
        {
          principal: 190622,
          interest: 11914,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 402536,
          paymentDate: '2027-10-15',
          remainingPrincipal: 2468711,
        },
        {
          principal: 176337,
          interest: 10286,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 386623,
          paymentDate: '2027-11-15',
          remainingPrincipal: 2092375,
        },
        {
          principal: 160952,
          interest: 8718,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 369670,
          paymentDate: '2027-12-15',
          remainingPrincipal: 1731422,
        },
        {
          principal: 144285,
          interest: 7214,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 351499,
          paymentDate: '2028-01-15',
          remainingPrincipal: 1387137,
        },
        {
          principal: 126103,
          interest: 5780,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 331883,
          paymentDate: '2028-02-15',
          remainingPrincipal: 1061034,
        },
        {
          principal: 106103,
          interest: 4421,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 310524,
          paymentDate: '2028-03-15',
          remainingPrincipal: 754931,
        },
        {
          principal: 83881,
          interest: 3146,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 287027,
          paymentDate: '2028-04-15',
          remainingPrincipal: 471050,
        },
        {
          principal: 58881,
          interest: 1963,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 260844,
          paymentDate: '2028-05-15',
          remainingPrincipal: 212169,
        },
        {
          principal: 30310,
          interest: 884,
          prepayment: 181859,
          prepaymentFee: 0,
          totalPayment: 213053,
          paymentDate: '2028-06-15',
          remainingPrincipal: 0,
        },
      ],
    },
    debtFreeDates: {
      '사금융 소액 고금리 대출': '2025-10-15',
      '은행 고금리 대출': '2027-09-15',
      '보험사 중금리 대출': '2028-06-15',
    },
  },
  {
    strategyType: 'HIGH_INTEREST_FIRST',
    totalMonths: 41,
    interestSaved: 1214354,
    totalPayment: 23048427,
    originalPayment: 24262781,
    totalPrepaymentFee: 8848,
    sortedLoanNames: [
      '은행 고금리 대출',
      '사금융 소액 고금리 대출',
      '보험사 중금리 대출',
    ],
    repaymentHistory: {
      '사금융 소액 고금리 대출': [
        {
          principal: 190247,
          interest: 25000,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 215247,
          paymentDate: '2025-08-15',
          remainingPrincipal: 809753,
        },
        {
          principal: 195003,
          interest: 20244,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 215247,
          paymentDate: '2025-09-15',
          remainingPrincipal: 614750,
        },
        {
          principal: 199878,
          interest: 15369,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 215247,
          paymentDate: '2025-10-15',
          remainingPrincipal: 414872,
        },
        {
          principal: 204875,
          interest: 10372,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 215247,
          paymentDate: '2025-11-15',
          remainingPrincipal: 209997,
        },
        {
          principal: 209997,
          interest: 5250,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 215247,
          paymentDate: '2025-12-15',
          remainingPrincipal: 0,
        },
      ],
      '은행 고금리 대출': [
        {
          principal: 232869,
          interest: 266667,
          prepayment: 200000,
          prepaymentFee: 1904,
          totalPayment: 701440,
          paymentDate: '2025-08-15',
          remainingPrincipal: 9567131,
        },
        {
          principal: 234184,
          interest: 255123,
          prepayment: 200000,
          prepaymentFee: 1836,
          totalPayment: 691143,
          paymentDate: '2025-09-15',
          remainingPrincipal: 9132947,
        },
        {
          principal: 235276,
          interest: 243545,
          prepayment: 200000,
          prepaymentFee: 1770,
          totalPayment: 680592,
          paymentDate: '2025-10-15',
          remainingPrincipal: 8697671,
        },
        {
          principal: 236121,
          interest: 231938,
          prepayment: 200000,
          prepaymentFee: 1702,
          totalPayment: 669761,
          paymentDate: '2025-11-15',
          remainingPrincipal: 8261550,
        },
        {
          principal: 236688,
          interest: 220308,
          prepayment: 200000,
          prepaymentFee: 1636,
          totalPayment: 658632,
          paymentDate: '2025-12-15',
          remainingPrincipal: 7824862,
        },
        {
          principal: 236943,
          interest: 208663,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 645606,
          paymentDate: '2026-01-15',
          remainingPrincipal: 7387919,
        },
        {
          principal: 236850,
          interest: 197011,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 633861,
          paymentDate: '2026-02-15',
          remainingPrincipal: 6951069,
        },
        {
          principal: 236365,
          interest: 185362,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 621727,
          paymentDate: '2026-03-15',
          remainingPrincipal: 6514704,
        },
        {
          principal: 235440,
          interest: 173725,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 609165,
          paymentDate: '2026-04-15',
          remainingPrincipal: 6079264,
        },
        {
          principal: 234019,
          interest: 162114,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 596133,
          paymentDate: '2026-05-15',
          remainingPrincipal: 5645245,
        },
        {
          principal: 232039,
          interest: 150540,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 582579,
          paymentDate: '2026-06-15',
          remainingPrincipal: 5213206,
        },
        {
          principal: 229425,
          interest: 139019,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 568444,
          paymentDate: '2026-07-15',
          remainingPrincipal: 4783781,
        },
        {
          principal: 226091,
          interest: 127567,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 553658,
          paymentDate: '2026-08-15',
          remainingPrincipal: 4357690,
        },
        {
          principal: 221934,
          interest: 116205,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 538139,
          paymentDate: '2026-09-15',
          remainingPrincipal: 3935756,
        },
        {
          principal: 216834,
          interest: 104953,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 521787,
          paymentDate: '2026-10-15',
          remainingPrincipal: 3518922,
        },
        {
          principal: 210644,
          interest: 93838,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 504482,
          paymentDate: '2026-11-15',
          remainingPrincipal: 3108278,
        },
        {
          principal: 203187,
          interest: 82887,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 486075,
          paymentDate: '2026-12-15',
          remainingPrincipal: 2705091,
        },
        {
          principal: 194244,
          interest: 72136,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 466380,
          paymentDate: '2027-01-15',
          remainingPrincipal: 2310847,
        },
        {
          principal: 183539,
          interest: 61623,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 445162,
          paymentDate: '2027-02-15',
          remainingPrincipal: 1927308,
        },
        {
          principal: 170718,
          interest: 51395,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 422113,
          paymentDate: '2027-03-15',
          remainingPrincipal: 1556590,
        },
        {
          principal: 155314,
          interest: 41509,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 396823,
          paymentDate: '2027-04-15',
          remainingPrincipal: 1201276,
        },
        {
          principal: 136697,
          interest: 32034,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 368731,
          paymentDate: '2027-05-15',
          remainingPrincipal: 864579,
        },
        {
          principal: 113977,
          interest: 23055,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 337032,
          paymentDate: '2027-06-15',
          remainingPrincipal: 550602,
        },
        {
          principal: 85837,
          interest: 14683,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 300520,
          paymentDate: '2027-07-15',
          remainingPrincipal: 264765,
        },
        {
          principal: 50203,
          interest: 7060,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 257264,
          paymentDate: '2027-08-15',
          remainingPrincipal: 14562,
        },
        {
          principal: 3498,
          interest: 388,
          prepayment: 11064,
          prepaymentFee: 0,
          totalPayment: 14950,
          paymentDate: '2027-09-15',
          remainingPrincipal: 0,
        },
      ],
      '보험사 중금리 대출': [
        {
          principal: 195122,
          interest: 33333,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 228455,
          paymentDate: '2025-08-15',
          remainingPrincipal: 7804878,
        },
        {
          principal: 195122,
          interest: 32520,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 227642,
          paymentDate: '2025-09-15',
          remainingPrincipal: 7609756,
        },
        {
          principal: 195122,
          interest: 31707,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 226829,
          paymentDate: '2025-10-15',
          remainingPrincipal: 7414634,
        },
        {
          principal: 195122,
          interest: 30894,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 226016,
          paymentDate: '2025-11-15',
          remainingPrincipal: 7219512,
        },
        {
          principal: 195122,
          interest: 30081,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 225203,
          paymentDate: '2025-12-15',
          remainingPrincipal: 7024390,
        },
        {
          principal: 195122,
          interest: 29268,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 224390,
          paymentDate: '2026-01-15',
          remainingPrincipal: 6829268,
        },
        {
          principal: 195122,
          interest: 28455,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 223577,
          paymentDate: '2026-02-15',
          remainingPrincipal: 6634146,
        },
        {
          principal: 195122,
          interest: 27642,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 222764,
          paymentDate: '2026-03-15',
          remainingPrincipal: 6439024,
        },
        {
          principal: 195122,
          interest: 26829,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 221951,
          paymentDate: '2026-04-15',
          remainingPrincipal: 6243902,
        },
        {
          principal: 195122,
          interest: 26016,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 221138,
          paymentDate: '2026-05-15',
          remainingPrincipal: 6048780,
        },
        {
          principal: 195122,
          interest: 25203,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 220325,
          paymentDate: '2026-06-15',
          remainingPrincipal: 5853658,
        },
        {
          principal: 195122,
          interest: 24390,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 219512,
          paymentDate: '2026-07-15',
          remainingPrincipal: 5658536,
        },
        {
          principal: 195122,
          interest: 23577,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 218699,
          paymentDate: '2026-08-15',
          remainingPrincipal: 5463414,
        },
        {
          principal: 195122,
          interest: 22764,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 217886,
          paymentDate: '2026-09-15',
          remainingPrincipal: 5268292,
        },
        {
          principal: 195122,
          interest: 21951,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 217073,
          paymentDate: '2026-10-15',
          remainingPrincipal: 5073170,
        },
        {
          principal: 195122,
          interest: 21138,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 216260,
          paymentDate: '2026-11-15',
          remainingPrincipal: 4878048,
        },
        {
          principal: 195122,
          interest: 20325,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 215447,
          paymentDate: '2026-12-15',
          remainingPrincipal: 4682926,
        },
        {
          principal: 195122,
          interest: 19512,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 214634,
          paymentDate: '2027-01-15',
          remainingPrincipal: 4487804,
        },
        {
          principal: 195122,
          interest: 18699,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 213821,
          paymentDate: '2027-02-15',
          remainingPrincipal: 4292682,
        },
        {
          principal: 195122,
          interest: 17886,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 213008,
          paymentDate: '2027-03-15',
          remainingPrincipal: 4097560,
        },
        {
          principal: 195122,
          interest: 17073,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 212195,
          paymentDate: '2027-04-15',
          remainingPrincipal: 3902438,
        },
        {
          principal: 195122,
          interest: 16260,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 211382,
          paymentDate: '2027-05-15',
          remainingPrincipal: 3707316,
        },
        {
          principal: 195122,
          interest: 15447,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 210569,
          paymentDate: '2027-06-15',
          remainingPrincipal: 3512194,
        },
        {
          principal: 195122,
          interest: 14634,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 209756,
          paymentDate: '2027-07-15',
          remainingPrincipal: 3317072,
        },
        {
          principal: 195122,
          interest: 13821,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 208943,
          paymentDate: '2027-08-15',
          remainingPrincipal: 3121950,
        },
        {
          principal: 195122,
          interest: 13008,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 208130,
          paymentDate: '2027-09-15',
          remainingPrincipal: 2926828,
        },
        {
          principal: 195122,
          interest: 12195,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 207317,
          paymentDate: '2027-10-15',
          remainingPrincipal: 2731706,
        },
        {
          principal: 195122,
          interest: 11382,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 206504,
          paymentDate: '2027-11-15',
          remainingPrincipal: 2536584,
        },
        {
          principal: 195122,
          interest: 10569,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 205691,
          paymentDate: '2027-12-15',
          remainingPrincipal: 2341462,
        },
        {
          principal: 195122,
          interest: 9756,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 204878,
          paymentDate: '2028-01-15',
          remainingPrincipal: 2146340,
        },
        {
          principal: 195122,
          interest: 8943,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 204065,
          paymentDate: '2028-02-15',
          remainingPrincipal: 1951218,
        },
        {
          principal: 195122,
          interest: 8130,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 203252,
          paymentDate: '2028-03-15',
          remainingPrincipal: 1756096,
        },
        {
          principal: 195122,
          interest: 7317,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 202439,
          paymentDate: '2028-04-15',
          remainingPrincipal: 1560974,
        },
        {
          principal: 195122,
          interest: 6504,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 201626,
          paymentDate: '2028-05-15',
          remainingPrincipal: 1365852,
        },
        {
          principal: 195122,
          interest: 5691,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 200813,
          paymentDate: '2028-06-15',
          remainingPrincipal: 1170730,
        },
        {
          principal: 195122,
          interest: 4878,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 200000,
          paymentDate: '2028-07-15',
          remainingPrincipal: 975608,
        },
        {
          principal: 195122,
          interest: 4065,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 199187,
          paymentDate: '2028-08-15',
          remainingPrincipal: 780486,
        },
        {
          principal: 195122,
          interest: 3252,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 198374,
          paymentDate: '2028-09-15',
          remainingPrincipal: 585365,
        },
        {
          principal: 195121,
          interest: 2439,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 197560,
          paymentDate: '2028-10-15',
          remainingPrincipal: 390243,
        },
        {
          principal: 195122,
          interest: 1626,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 196748,
          paymentDate: '2028-11-15',
          remainingPrincipal: 195122,
        },
        {
          principal: 195121,
          interest: 813,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 195934,
          paymentDate: '2028-12-15',
          remainingPrincipal: 0,
        },
      ],
    },
    debtFreeDates: {
      '사금융 소액 고금리 대출': '2025-12-15',
      '은행 고금리 대출': '2027-09-15',
      '보험사 중금리 대출': '2028-12-15',
    },
  },
  {
    strategyType: 'SMALL_AMOUNT_FIRST',
    totalMonths: 29,
    interestSaved: 296740,
    totalPayment: 23966041,
    originalPayment: 24262781,
    totalPrepaymentFee: 3954,
    sortedLoanNames: [
      '사금융 소액 고금리 대출',
      '보험사 중금리 대출',
      '은행 고금리 대출',
    ],
    repaymentHistory: {
      '사금융 소액 고금리 대출': [
        {
          principal: 190247,
          interest: 25000,
          prepayment: 200000,
          prepaymentFee: 381,
          totalPayment: 415628,
          paymentDate: '2025-08-15',
          remainingPrincipal: 609753,
        },
        {
          principal: 146839,
          interest: 15244,
          prepayment: 200000,
          prepaymentFee: 296,
          totalPayment: 362379,
          paymentDate: '2025-09-15',
          remainingPrincipal: 262914,
        },
        {
          principal: 85483,
          interest: 6573,
          prepayment: 177431,
          prepaymentFee: 190,
          totalPayment: 269677,
          paymentDate: '2025-10-15',
          remainingPrincipal: 0,
        },
      ],
      '보험사 중금리 대출': [
        {
          principal: 195122,
          interest: 33333,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 228455,
          paymentDate: '2025-08-15',
          remainingPrincipal: 7804878,
        },
        {
          principal: 195122,
          interest: 32520,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 227642,
          paymentDate: '2025-09-15',
          remainingPrincipal: 7609756,
        },
        {
          principal: 195122,
          interest: 31707,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 226829,
          paymentDate: '2025-10-15',
          remainingPrincipal: 7414634,
        },
        {
          principal: 195122,
          interest: 30894,
          prepayment: 200000,
          prepaymentFee: 1564,
          totalPayment: 427580,
          paymentDate: '2025-11-15',
          remainingPrincipal: 7019512,
        },
        {
          principal: 189717,
          interest: 29248,
          prepayment: 200000,
          prepaymentFee: 1523,
          totalPayment: 420488,
          paymentDate: '2025-12-15',
          remainingPrincipal: 6629795,
        },
        {
          principal: 184161,
          interest: 27624,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 411785,
          paymentDate: '2026-01-15',
          remainingPrincipal: 6245634,
        },
        {
          principal: 178447,
          interest: 26023,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 404470,
          paymentDate: '2026-02-15',
          remainingPrincipal: 5867187,
        },
        {
          principal: 172564,
          interest: 24447,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 397011,
          paymentDate: '2026-03-15',
          remainingPrincipal: 5494623,
        },
        {
          principal: 166504,
          interest: 22894,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 389398,
          paymentDate: '2026-04-15',
          remainingPrincipal: 5128119,
        },
        {
          principal: 160254,
          interest: 21367,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 381621,
          paymentDate: '2026-05-15',
          remainingPrincipal: 4767865,
        },
        {
          principal: 153802,
          interest: 19866,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 373668,
          paymentDate: '2026-06-15',
          remainingPrincipal: 4414063,
        },
        {
          principal: 147135,
          interest: 18392,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 365527,
          paymentDate: '2026-07-15',
          remainingPrincipal: 4066928,
        },
        {
          principal: 140239,
          interest: 16946,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 357184,
          paymentDate: '2026-08-15',
          remainingPrincipal: 3726689,
        },
        {
          principal: 133096,
          interest: 15528,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 348624,
          paymentDate: '2026-09-15',
          remainingPrincipal: 3393593,
        },
        {
          principal: 125689,
          interest: 14140,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 339829,
          paymentDate: '2026-10-15',
          remainingPrincipal: 3067904,
        },
        {
          principal: 117996,
          interest: 12783,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 330779,
          paymentDate: '2026-11-15',
          remainingPrincipal: 2749908,
        },
        {
          principal: 109996,
          interest: 11458,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 321454,
          paymentDate: '2026-12-15',
          remainingPrincipal: 2439912,
        },
        {
          principal: 101663,
          interest: 10166,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 311829,
          paymentDate: '2027-01-15',
          remainingPrincipal: 2138249,
        },
        {
          principal: 92967,
          interest: 8909,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 301877,
          paymentDate: '2027-02-15',
          remainingPrincipal: 1845282,
        },
        {
          principal: 83876,
          interest: 7689,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 291565,
          paymentDate: '2027-03-15',
          remainingPrincipal: 1561406,
        },
        {
          principal: 74353,
          interest: 6506,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 280859,
          paymentDate: '2027-04-15',
          remainingPrincipal: 1287053,
        },
        {
          principal: 64353,
          interest: 5363,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 269715,
          paymentDate: '2027-05-15',
          remainingPrincipal: 1022700,
        },
        {
          principal: 53826,
          interest: 4261,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 258088,
          paymentDate: '2027-06-15',
          remainingPrincipal: 768874,
        },
        {
          principal: 42715,
          interest: 3204,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 245919,
          paymentDate: '2027-07-15',
          remainingPrincipal: 526159,
        },
        {
          principal: 30951,
          interest: 2192,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 233143,
          paymentDate: '2027-08-15',
          remainingPrincipal: 295208,
        },
        {
          principal: 18451,
          interest: 1230,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 219681,
          paymentDate: '2027-09-15',
          remainingPrincipal: 76758,
        },
        {
          principal: 5117,
          interest: 320,
          prepayment: 71640,
          prepaymentFee: 0,
          totalPayment: 77077,
          paymentDate: '2027-10-15',
          remainingPrincipal: 0,
        },
      ],
      '은행 고금리 대출': [
        {
          principal: 232869,
          interest: 266667,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-08-15',
          remainingPrincipal: 9767131,
        },
        {
          principal: 239079,
          interest: 260457,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-09-15',
          remainingPrincipal: 9528052,
        },
        {
          principal: 245455,
          interest: 254081,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-10-15',
          remainingPrincipal: 9282597,
        },
        {
          principal: 252000,
          interest: 247536,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-11-15',
          remainingPrincipal: 9030597,
        },
        {
          principal: 258720,
          interest: 240816,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-12-15',
          remainingPrincipal: 8771877,
        },
        {
          principal: 265619,
          interest: 233917,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-01-15',
          remainingPrincipal: 8506258,
        },
        {
          principal: 272703,
          interest: 226834,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-02-15',
          remainingPrincipal: 8233555,
        },
        {
          principal: 279975,
          interest: 219561,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-03-15',
          remainingPrincipal: 7953580,
        },
        {
          principal: 287441,
          interest: 212095,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-04-15',
          remainingPrincipal: 7666139,
        },
        {
          principal: 295106,
          interest: 204430,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-05-15',
          remainingPrincipal: 7371033,
        },
        {
          principal: 302975,
          interest: 196561,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-06-15',
          remainingPrincipal: 7068058,
        },
        {
          principal: 311055,
          interest: 188482,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-07-15',
          remainingPrincipal: 6757003,
        },
        {
          principal: 319349,
          interest: 180187,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-08-15',
          remainingPrincipal: 6437654,
        },
        {
          principal: 327865,
          interest: 171671,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-09-15',
          remainingPrincipal: 6109789,
        },
        {
          principal: 336608,
          interest: 162928,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-10-15',
          remainingPrincipal: 5773181,
        },
        {
          principal: 345585,
          interest: 153951,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-11-15',
          remainingPrincipal: 5427596,
        },
        {
          principal: 354800,
          interest: 144736,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2026-12-15',
          remainingPrincipal: 5072796,
        },
        {
          principal: 364262,
          interest: 135275,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2027-01-15',
          remainingPrincipal: 4708534,
        },
        {
          principal: 373975,
          interest: 125561,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2027-02-15',
          remainingPrincipal: 4334559,
        },
        {
          principal: 383948,
          interest: 115588,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2027-03-15',
          remainingPrincipal: 3950611,
        },
        {
          principal: 394186,
          interest: 105350,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2027-04-15',
          remainingPrincipal: 3556425,
        },
        {
          principal: 404698,
          interest: 94838,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2027-05-15',
          remainingPrincipal: 3151727,
        },
        {
          principal: 415490,
          interest: 84046,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2027-06-15',
          remainingPrincipal: 2736237,
        },
        {
          principal: 426570,
          interest: 72966,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2027-07-15',
          remainingPrincipal: 2309667,
        },
        {
          principal: 437945,
          interest: 61591,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2027-08-15',
          remainingPrincipal: 1871722,
        },
        {
          principal: 449624,
          interest: 49913,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2027-09-15',
          remainingPrincipal: 1422098,
        },
        {
          principal: 461614,
          interest: 37923,
          prepayment: 123243,
          prepaymentFee: 0,
          totalPayment: 622779,
          paymentDate: '2027-10-15',
          remainingPrincipal: 837241,
        },
        {
          principal: 413112,
          interest: 22326,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 635439,
          paymentDate: '2027-11-15',
          remainingPrincipal: 224129,
        },
        {
          principal: 224129,
          interest: 5977,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 230106,
          paymentDate: '2027-12-15',
          remainingPrincipal: 0,
        },
      ],
    },
    debtFreeDates: {
      '사금융 소액 고금리 대출': '2025-10-15',
      '보험사 중금리 대출': '2027-10-15',
      '은행 고금리 대출': '2027-12-15',
    },
  },
  {
    strategyType: 'OLDEST_FIRST',
    totalMonths: 35,
    interestSaved: 1047115,
    totalPayment: 23215666,
    originalPayment: 24262781,
    totalPrepaymentFee: 4205,
    sortedLoanNames: [
      '사금융 소액 고금리 대출',
      '은행 고금리 대출',
      '보험사 중금리 대출',
    ],
    repaymentHistory: {
      '사금융 소액 고금리 대출': [
        {
          principal: 190247,
          interest: 25000,
          prepayment: 200000,
          prepaymentFee: 381,
          totalPayment: 415628,
          paymentDate: '2025-08-15',
          remainingPrincipal: 609753,
        },
        {
          principal: 146839,
          interest: 15244,
          prepayment: 200000,
          prepaymentFee: 296,
          totalPayment: 362379,
          paymentDate: '2025-09-15',
          remainingPrincipal: 262914,
        },
        {
          principal: 85483,
          interest: 6573,
          prepayment: 177431,
          prepaymentFee: 190,
          totalPayment: 269677,
          paymentDate: '2025-10-15',
          remainingPrincipal: 0,
        },
      ],
      '은행 고금리 대출': [
        {
          principal: 232869,
          interest: 266667,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-08-15',
          remainingPrincipal: 9767131,
        },
        {
          principal: 239079,
          interest: 260457,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-09-15',
          remainingPrincipal: 9528052,
        },
        {
          principal: 245455,
          interest: 254081,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 499536,
          paymentDate: '2025-10-15',
          remainingPrincipal: 9282597,
        },
        {
          principal: 252000,
          interest: 247536,
          prepayment: 200000,
          prepaymentFee: 1702,
          totalPayment: 701238,
          paymentDate: '2025-11-15',
          remainingPrincipal: 8830597,
        },
        {
          principal: 252990,
          interest: 235483,
          prepayment: 200000,
          prepaymentFee: 1636,
          totalPayment: 690109,
          paymentDate: '2025-12-15',
          remainingPrincipal: 8377607,
        },
        {
          principal: 253681,
          interest: 223403,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 677083,
          paymentDate: '2026-01-15',
          remainingPrincipal: 7923926,
        },
        {
          principal: 254034,
          interest: 211305,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 665338,
          paymentDate: '2026-02-15',
          remainingPrincipal: 7469892,
        },
        {
          principal: 254007,
          interest: 199197,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 653204,
          paymentDate: '2026-03-15',
          remainingPrincipal: 7015885,
        },
        {
          principal: 253553,
          interest: 187090,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 640643,
          paymentDate: '2026-04-15',
          remainingPrincipal: 6562332,
        },
        {
          principal: 252615,
          interest: 174996,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 627611,
          paymentDate: '2026-05-15',
          remainingPrincipal: 6109717,
        },
        {
          principal: 251131,
          interest: 162926,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 614057,
          paymentDate: '2026-06-15',
          remainingPrincipal: 5658586,
        },
        {
          principal: 249026,
          interest: 150896,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 599921,
          paymentDate: '2026-07-15',
          remainingPrincipal: 5209560,
        },
        {
          principal: 246214,
          interest: 138922,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 585136,
          paymentDate: '2026-08-15',
          remainingPrincipal: 4763346,
        },
        {
          principal: 242594,
          interest: 127023,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 569617,
          paymentDate: '2026-09-15',
          remainingPrincipal: 4320752,
        },
        {
          principal: 238044,
          interest: 115220,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 553265,
          paymentDate: '2026-10-15',
          remainingPrincipal: 3882708,
        },
        {
          principal: 232420,
          interest: 103539,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 535959,
          paymentDate: '2026-11-15',
          remainingPrincipal: 3450288,
        },
        {
          principal: 225544,
          interest: 92008,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 517552,
          paymentDate: '2026-12-15',
          remainingPrincipal: 3024744,
        },
        {
          principal: 217197,
          interest: 80660,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 497857,
          paymentDate: '2027-01-15',
          remainingPrincipal: 2607547,
        },
        {
          principal: 207104,
          interest: 69535,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 476639,
          paymentDate: '2027-02-15',
          remainingPrincipal: 2200443,
        },
        {
          principal: 194912,
          interest: 58678,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 453590,
          paymentDate: '2027-03-15',
          remainingPrincipal: 1805531,
        },
        {
          principal: 180153,
          interest: 48147,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 428301,
          paymentDate: '2027-04-15',
          remainingPrincipal: 1425378,
        },
        {
          principal: 162199,
          interest: 38010,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 400209,
          paymentDate: '2027-05-15',
          remainingPrincipal: 1063179,
        },
        {
          principal: 140158,
          interest: 28351,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 368510,
          paymentDate: '2027-06-15',
          remainingPrincipal: 723021,
        },
        {
          principal: 112716,
          interest: 19281,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 331997,
          paymentDate: '2027-07-15',
          remainingPrincipal: 410305,
        },
        {
          principal: 77800,
          interest: 10941,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 288741,
          paymentDate: '2027-08-15',
          remainingPrincipal: 132505,
        },
        {
          principal: 31830,
          interest: 3533,
          prepayment: 100675,
          prepaymentFee: 0,
          totalPayment: 136038,
          paymentDate: '2027-09-15',
          remainingPrincipal: 0,
        },
      ],
      '보험사 중금리 대출': [
        {
          principal: 195122,
          interest: 33333,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 228455,
          paymentDate: '2025-08-15',
          remainingPrincipal: 7804878,
        },
        {
          principal: 195122,
          interest: 32520,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 227642,
          paymentDate: '2025-09-15',
          remainingPrincipal: 7609756,
        },
        {
          principal: 195122,
          interest: 31707,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 226829,
          paymentDate: '2025-10-15',
          remainingPrincipal: 7414634,
        },
        {
          principal: 195122,
          interest: 30894,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 226016,
          paymentDate: '2025-11-15',
          remainingPrincipal: 7219512,
        },
        {
          principal: 195122,
          interest: 30081,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 225203,
          paymentDate: '2025-12-15',
          remainingPrincipal: 7024390,
        },
        {
          principal: 195122,
          interest: 29268,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 224390,
          paymentDate: '2026-01-15',
          remainingPrincipal: 6829268,
        },
        {
          principal: 195122,
          interest: 28455,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 223577,
          paymentDate: '2026-02-15',
          remainingPrincipal: 6634146,
        },
        {
          principal: 195122,
          interest: 27642,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 222764,
          paymentDate: '2026-03-15',
          remainingPrincipal: 6439024,
        },
        {
          principal: 195122,
          interest: 26829,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 221951,
          paymentDate: '2026-04-15',
          remainingPrincipal: 6243902,
        },
        {
          principal: 195122,
          interest: 26016,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 221138,
          paymentDate: '2026-05-15',
          remainingPrincipal: 6048780,
        },
        {
          principal: 195122,
          interest: 25203,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 220325,
          paymentDate: '2026-06-15',
          remainingPrincipal: 5853658,
        },
        {
          principal: 195122,
          interest: 24390,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 219512,
          paymentDate: '2026-07-15',
          remainingPrincipal: 5658536,
        },
        {
          principal: 195122,
          interest: 23577,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 218699,
          paymentDate: '2026-08-15',
          remainingPrincipal: 5463414,
        },
        {
          principal: 195122,
          interest: 22764,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 217886,
          paymentDate: '2026-09-15',
          remainingPrincipal: 5268292,
        },
        {
          principal: 195122,
          interest: 21951,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 217073,
          paymentDate: '2026-10-15',
          remainingPrincipal: 5073170,
        },
        {
          principal: 195122,
          interest: 21138,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 216260,
          paymentDate: '2026-11-15',
          remainingPrincipal: 4878048,
        },
        {
          principal: 195122,
          interest: 20325,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 215447,
          paymentDate: '2026-12-15',
          remainingPrincipal: 4682926,
        },
        {
          principal: 195122,
          interest: 19512,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 214634,
          paymentDate: '2027-01-15',
          remainingPrincipal: 4487804,
        },
        {
          principal: 195122,
          interest: 18699,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 213821,
          paymentDate: '2027-02-15',
          remainingPrincipal: 4292682,
        },
        {
          principal: 195122,
          interest: 17886,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 213008,
          paymentDate: '2027-03-15',
          remainingPrincipal: 4097560,
        },
        {
          principal: 195122,
          interest: 17073,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 212195,
          paymentDate: '2027-04-15',
          remainingPrincipal: 3902438,
        },
        {
          principal: 195122,
          interest: 16260,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 211382,
          paymentDate: '2027-05-15',
          remainingPrincipal: 3707316,
        },
        {
          principal: 195122,
          interest: 15447,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 210569,
          paymentDate: '2027-06-15',
          remainingPrincipal: 3512194,
        },
        {
          principal: 195122,
          interest: 14634,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 209756,
          paymentDate: '2027-07-15',
          remainingPrincipal: 3317072,
        },
        {
          principal: 195122,
          interest: 13821,
          prepayment: 0,
          prepaymentFee: 0,
          totalPayment: 208943,
          paymentDate: '2027-08-15',
          remainingPrincipal: 3121950,
        },
        {
          principal: 195122,
          interest: 13008,
          prepayment: 67495,
          prepaymentFee: 0,
          totalPayment: 275625,
          paymentDate: '2027-09-15',
          remainingPrincipal: 2859333,
        },
        {
          principal: 190622,
          interest: 11914,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 402536,
          paymentDate: '2027-10-15',
          remainingPrincipal: 2468711,
        },
        {
          principal: 176337,
          interest: 10286,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 386623,
          paymentDate: '2027-11-15',
          remainingPrincipal: 2092375,
        },
        {
          principal: 160952,
          interest: 8718,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 369670,
          paymentDate: '2027-12-15',
          remainingPrincipal: 1731422,
        },
        {
          principal: 144285,
          interest: 7214,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 351499,
          paymentDate: '2028-01-15',
          remainingPrincipal: 1387137,
        },
        {
          principal: 126103,
          interest: 5780,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 331883,
          paymentDate: '2028-02-15',
          remainingPrincipal: 1061034,
        },
        {
          principal: 106103,
          interest: 4421,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 310524,
          paymentDate: '2028-03-15',
          remainingPrincipal: 754931,
        },
        {
          principal: 83881,
          interest: 3146,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 287027,
          paymentDate: '2028-04-15',
          remainingPrincipal: 471050,
        },
        {
          principal: 58881,
          interest: 1963,
          prepayment: 200000,
          prepaymentFee: 0,
          totalPayment: 260844,
          paymentDate: '2028-05-15',
          remainingPrincipal: 212169,
        },
        {
          principal: 30310,
          interest: 884,
          prepayment: 181859,
          prepaymentFee: 0,
          totalPayment: 213053,
          paymentDate: '2028-06-15',
          remainingPrincipal: 0,
        },
      ],
    },
    debtFreeDates: {
      '사금융 소액 고금리 대출': '2025-10-15',
      '은행 고금리 대출': '2027-09-15',
      '보험사 중금리 대출': '2028-06-15',
    },
  },
]);

const sourceRepayments = computed(() => {
  return props.repayments.length > 0 ? props.repayments : testRepayments.value;
});

const chartData = ref({ labels: [], datasets: [] });
const lastPaymentDate = computed(() => {
  let latest = null;

  sourceRepayments.value.forEach((strategy) => {
    Object.values(strategy.repaymentHistory).forEach((loanHistory) => {
      const lastEntry = loanHistory[loanHistory.length - 1];
      if (!latest || dayjs(lastEntry.paymentDate).isAfter(dayjs(latest))) {
        latest = lastEntry.paymentDate;
      }
    });
  });
  return latest ? dayjs(latest) : dayjs();
});
const slicedMonths = computed(() => {
  if (!lastPaymentDate.value) return [];

  // 월 단위 시작 (현재 달 기준)
  const start = dayjs().startOf('month');
  const end = lastPaymentDate.value.startOf('month');

  const months = [];
  let current = start;

  while (current.isBefore(end) || current.isSame(end)) {
    months.push(current.format('YYYY-MM'));
    current = current.add(1, 'month');
  }
  return months;
});
watch(
  sourceRepayments,
  (repayments) => {
    if (!Array.isArray(repayments)) return;

    const allMonthsSet = new Set();

    repayments.forEach((strategy) => {
      Object.values(strategy.repaymentHistory).forEach((loanHistory) => {
        loanHistory.forEach((entry) => {
          const month = entry.paymentDate.slice(0, 7);
          allMonthsSet.add(month);
        });
      });
    });
    const filteredMonths = slicedMonths.value.filter((m) =>
      allMonthsSet.has(m)
    );

    const strategiesData = repayments.map((strategy) => {
      const monthlyTotals = {};

      Object.values(strategy.repaymentHistory).forEach((loanHistory) => {
        loanHistory.forEach((entry) => {
          const month = entry.paymentDate.slice(0, 7);
          if (!monthlyTotals[month]) monthlyTotals[month] = 0;
          monthlyTotals[month] += entry.remainingPrincipal;
        });
      });

      return {
        label: mapStrategyLabel(strategy.strategyType),
        dataMap: monthlyTotals,
      };
    });

    chartData.value = {
      labels: filteredMonths,
      datasets: strategiesData.map((strategy, index) => {
        const data = filteredMonths.map((m) => strategy.dataMap[m] ?? null);

        // 마지막 잔여원금 0인 월 인덱스 찾기
        // strategy.dataMap의 key는 월 문자열(YYYY-MM)
        // allMonths는 정렬된 월 배열
        let lastZeroIndex = -1;
        for (let i = filteredMonths.length - 1; i >= 0; i--) {
          const month = filteredMonths[i];
          if (strategy.dataMap[month] === 0) {
            lastZeroIndex = i;
            break;
          }
        }

        const pointRadius = filteredMonths.map((_, i) => {
          if (i % 6 === 0) return 4; // 6개월 단위 점
          if (i === lastZeroIndex) return 4; // 마지막 0점도 크게
          return 0; // 나머지는 점 숨김
        });

        const pointHoverRadius = filteredMonths.map((_, i) => {
          if (i % 6 === 0) return 6;
          if (i === lastZeroIndex) return 6;
          return 0;
        });

        return {
          label: strategy.label,
          data,
          borderColor: getColor(index),
          tension: 0.3,
          fill: false,
          pointRadius,
          pointHoverRadius,
        };
      }),
    };
  },
  { immediate: true }
);

const maxRemainingPrincipal = computed(() => {
  if (!sourceRepayments.value.length) return 0;

  let maxVal = 0;
  sourceRepayments.value.forEach((strategy) => {
    Object.values(strategy.repaymentHistory).forEach((loanHistory) => {
      loanHistory.forEach((entry) => {
        if (entry.remainingPrincipal > maxVal)
          maxVal = entry.remainingPrincipal;
      });
    });
  });

  return maxVal;
});

const chartOptions = computed(() => ({
  responsive: true,
  maintainAspectRatio: false,
  plugins: {
    legend: { position: 'bottom' },
    tooltip: {
      callbacks: {
        label: (context) => `\u20a9${context.formattedValue}`,
      },
    },
  },
  scales: {
    x: {
      ticks: {
        callback: (val, index) => {
          if (index === 0) return '현재';
          if (index % 6 === 0) return `${index}개월`;
          return '';
        },
        maxRotation: 0,
        autoSkip: false,
      },
      grid: {
        drawTicks: true,
        drawOnChartArea: true,
        color: function (context) {
          const index = context.tick?.index;
          return index !== undefined && index % 6 === 0
            ? '#ccc'
            : 'transparent';
        },
      },
    },

    y: {
      beginAtZero: true,
      suggestedMax:
        Math.ceil(maxRemainingPrincipal.value / 1000000) * 1000000 + 1000000, // 최대값에 100만원 더 여유
      ticks: {
        stepSize: 1000000,
        maxTicksLimit: 10,
        callback: (value) => `\u20a9${value.toLocaleString()}`,
      },
      grid: {
        drawOnChartArea: false,
      },
    },
  },
}));

function getColor(index) {
  const colors = ['#2f855a', '#3182ce', '#dd6b20', '#805ad5'];
  return colors[index % colors.length];
}

function mapStrategyLabel(type) {
  switch (type) {
    case 'TCS_RECOMMEND':
      return '우리 앱 추천';
    case 'HIGH_INTEREST_FIRST':
      return '고금리 우선';
    case 'SMALL_AMOUNT_FIRST':
      return '소액 우선';
    case 'OLDEST_FIRST':
      return '오래된 순';
    default:
      return type;
  }
}
</script>
